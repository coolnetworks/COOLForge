{
  "openapi": "3.1.0",
  "info": {
    "title": "Level v2 REST API",
    "version": "v2"
  },
  "tags": [
    {
      "name": "Devices",
      "description": "Devices with the Level agent installed."
    },
    {
      "name": "Groups",
      "description": "The group hierachy that contains devices."
    },
    {
      "name": "Alerts",
      "description": "Alerts generated by monitoring devices."
    },
    {
      "name": "Automations",
      "description": "Operations on automations."
    },
    {
      "name": "Tags",
      "description": "Tags that can be applied to devices."
    },
    {
      "name": "Custom Fields",
      "description": "Custom fields that can have values assigned to them."
    },
    {
      "name": "Custom Field Values",
      "description": "Values assigned to custom fields for the organization, groups, and devices."
    }
  ],
  "paths": {
    "/v2/alerts": {
      "get": {
        "summary": "List alerts",
        "tags": ["Alerts"],
        "operationId": "listAlerts",
        "security": [{"api_key": []}],
        "description": "Returns a list of your alerts.",
        "parameters": [
          {
            "name": "device_id",
            "in": "query",
            "required": false,
            "schema": {"type": "string"},
            "description": "Filter to only include alerts for the specified device_id."
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {"type": "string", "enum": ["active", "resolved"]},
            "description": "Filter to only include alerts with the given status."
          },
          {"name": "limit", "in": "query", "required": false, "schema": {"$ref": "#/components/schemas/limit"}},
          {"name": "starting_after", "in": "query", "required": false, "schema": {"$ref": "#/components/schemas/starting_after"}},
          {"name": "ending_before", "in": "query", "required": false, "schema": {"$ref": "#/components/schemas/ending_before"}}
        ]
      }
    },
    "/v2/alerts/{id}": {
      "get": {
        "summary": "Show alert",
        "tags": ["Alerts"],
        "operationId": "showAlert",
        "description": "Retrieves the details of an existing alert."
      }
    },
    "/v2/custom_field_values": {
      "get": {
        "summary": "List custom field values",
        "tags": ["Custom Field Values"],
        "operationId": "listCustomFieldValues",
        "description": "Returns a list of custom field values for the organization, groups, or devices.",
        "parameters": [
          {
            "name": "assigned_to_id",
            "in": "query",
            "required": false,
            "schema": {"type": "string", "nullable": true},
            "description": "Filter to only include custom field values for the specified object. If not provided, global custom field values for the organization are returned."
          }
        ]
      },
      "patch": {
        "summary": "Update custom field value",
        "tags": ["Custom Field Values"],
        "operationId": "updateCustomFieldValue",
        "description": "Set a custom field value for the organization, group, or device.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["custom_field_id", "value"],
                "properties": {
                  "custom_field_id": {"type": "string", "description": "The ID of the custom field to set the value for."},
                  "assigned_to_id": {"type": "string", "nullable": true, "description": "The ID of the object to set the value for."},
                  "value": {"type": "string", "description": "The value to set for the custom field."},
                  "force": {"type": "boolean", "description": "When true, override any custom field values set for descendants."}
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete custom field value",
        "tags": ["Custom Field Values"],
        "operationId": "deleteCustomFieldValue",
        "description": "Deletes a custom field value for the organization, group, or device."
      }
    },
    "/v2/custom_fields": {
      "get": {
        "summary": "List custom fields",
        "tags": ["Custom Fields"],
        "operationId": "listCustomFields",
        "description": "Returns a list of custom fields."
      },
      "post": {
        "summary": "Create custom field",
        "tags": ["Custom Fields"],
        "operationId": "createCustomField",
        "description": "Creates a custom field.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name"],
                "properties": {
                  "name": {"type": "string", "example": "Region", "description": "The name of the custom field."},
                  "admin_only": {"type": "boolean", "example": false, "description": "When true, this field's value can only be viewed or edited by an admin."}
                }
              }
            }
          }
        }
      }
    },
    "/v2/custom_fields/{id}": {
      "get": {"summary": "Show custom field", "tags": ["Custom Fields"], "operationId": "showCustomField"},
      "patch": {"summary": "Update custom field", "tags": ["Custom Fields"], "operationId": "updateCustomField"},
      "delete": {"summary": "Delete custom field", "tags": ["Custom Fields"], "operationId": "deleteCustomField"}
    },
    "/v2/devices": {
      "get": {
        "summary": "List devices",
        "tags": ["Devices"],
        "operationId": "listDevices",
        "description": "Returns a list of your devices.",
        "parameters": [
          {"name": "group_id", "in": "query", "description": "Filter to only include devices with the given parent group id."},
          {"name": "ancestor_group_id", "in": "query", "description": "Filter to only include devices with the given group id as an ancestor."},
          {"name": "tag_id", "in": "query", "description": "Filter to only include devices that have the specified tag."},
          {"name": "hostname", "in": "query", "description": "Filter to only include devices with the specified hostname."},
          {"name": "serial_number", "in": "query", "description": "Filter to only include devices with the specified serial number."},
          {"name": "include_operating_system", "in": "query", "schema": {"type": "boolean"}, "description": "Include detailed operating system information."},
          {"name": "include_cpus", "in": "query", "schema": {"type": "boolean"}, "description": "Include detailed CPU information."},
          {"name": "include_memory", "in": "query", "schema": {"type": "boolean"}, "description": "Include detailed memory information."},
          {"name": "include_disks", "in": "query", "schema": {"type": "boolean"}, "description": "Include detailed disk information."},
          {"name": "include_network_interfaces", "in": "query", "schema": {"type": "boolean"}, "description": "Include detailed network interface information."}
        ]
      }
    },
    "/v2/devices/{id}": {
      "get": {"summary": "Show device", "tags": ["Devices"], "operationId": "showDevice"},
      "patch": {
        "summary": "Update device",
        "tags": ["Devices"],
        "operationId": "updateDevice",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "name": {"type": "string", "description": "The name of the device."},
                  "notes": {"type": "string", "description": "The notes for the device."},
                  "group_id": {"type": "string", "nullable": true, "description": "The ID of the group to assign the device to."}
                }
              }
            }
          }
        }
      },
      "delete": {"summary": "Delete device", "tags": ["Devices"], "operationId": "deleteDevice"}
    },
    "/v2/groups": {
      "get": {
        "summary": "List groups",
        "tags": ["Groups"],
        "operationId": "listGroups",
        "description": "Returns a list of your groups.",
        "parameters": [
          {"name": "parent_id", "in": "query", "description": "Filter to only include groups with the given parent id. Use 'null' for root groups."}
        ]
      },
      "post": {
        "summary": "Create group",
        "tags": ["Groups"],
        "operationId": "createGroup",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "required": ["name"],
                "properties": {
                  "name": {"type": "string", "description": "The name of the group."},
                  "parent_id": {"type": "string", "nullable": true, "description": "The parent group ID."}
                }
              }
            }
          }
        }
      }
    },
    "/v2/groups/{id}": {
      "get": {"summary": "Show group", "tags": ["Groups"], "operationId": "showGroup"},
      "patch": {"summary": "Update group", "tags": ["Groups"], "operationId": "updateGroup"},
      "delete": {"summary": "Delete group", "tags": ["Groups"], "operationId": "deleteGroup"}
    },
    "/v2/groups/{id}/devices": {
      "post": {
        "summary": "Assign devices to group",
        "tags": ["Groups"],
        "operationId": "assignGroupDevices",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "required": ["device_ids"],
                "properties": {
                  "device_ids": {"type": "array", "items": {"type": "string"}, "description": "An array of device IDs to assign to the group."}
                }
              }
            }
          }
        }
      },
      "delete": {"summary": "Remove devices from group", "tags": ["Groups"], "operationId": "removeGroupDevices"}
    },
    "/v2/tags": {
      "get": {
        "summary": "List tags",
        "tags": ["Tags"],
        "operationId": "listTags",
        "parameters": [
          {"name": "device_id", "in": "query", "description": "Filter to only include tags for the specified device."}
        ]
      },
      "post": {
        "summary": "Create tag",
        "tags": ["Tags"],
        "operationId": "createTag",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "required": ["name"],
                "properties": {"name": {"type": "string", "description": "The tag name."}}
              }
            }
          }
        }
      }
    },
    "/v2/tags/{id}": {
      "get": {"summary": "Show tag", "tags": ["Tags"], "operationId": "showTag"},
      "patch": {"summary": "Update tag", "tags": ["Tags"], "operationId": "updateTag"},
      "delete": {"summary": "Delete tag", "tags": ["Tags"], "operationId": "deleteTag"}
    },
    "/v2/tags/{id}/devices": {
      "post": {"summary": "Tag devices", "tags": ["Tags"], "operationId": "tagDevices"},
      "delete": {"summary": "Remove tag from devices", "tags": ["Tags"], "operationId": "removeTagFromDevices"}
    },
    "/v2/automations/webhooks/{token}": {
      "post": {
        "summary": "Trigger webhook",
        "tags": ["Automations"],
        "operationId": "triggerWebhook",
        "description": "Triggers an automation via a webhook."
      }
    }
  },
  "webhooks": {
    "alert_active": {"post": {"summary": "Alert Active Webhook", "description": "Sent when an alert becomes active"}},
    "alert_resolved": {"post": {"summary": "Alert Resolved Webhook", "description": "Sent when an alert is resolved"}},
    "device_created": {"post": {"summary": "Device Created Webhook", "description": "Sent when a device is created"}},
    "device_updated": {"post": {"summary": "Device Updated Webhook", "description": "Sent when a device is updated"}},
    "device_deleted": {"post": {"summary": "Device Deleted Webhook", "description": "Sent when a device is deleted"}},
    "group_created": {"post": {"summary": "Group Created Webhook", "description": "Sent when a group is created"}},
    "group_updated": {"post": {"summary": "Group Updated Webhook", "description": "Sent when a group is updated"}},
    "group_deleted": {"post": {"summary": "Group Deleted Webhook", "description": "Sent when a group is deleted"}}
  },
  "servers": [{"url": "https://api.level.io"}],
  "components": {
    "securitySchemes": {
      "api_key": {"type": "apiKey", "name": "Authorization", "in": "header"}
    },
    "schemas": {
      "limit": {"type": "string", "example": "20", "description": "Limit on objects returned (1-100, default 20)."},
      "starting_after": {"type": "string", "description": "Cursor for pagination - fetch next page after this ID."},
      "ending_before": {"type": "string", "description": "Cursor for pagination - fetch previous page before this ID."},
      "has_more": {"type": "boolean", "description": "Returns true if there's another page of items."},
      "group": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "The ID of the group."},
          "parent_id": {"type": "string", "nullable": true, "description": "The ID of the group's parent group."},
          "child_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the group's direct children."},
          "name": {"type": "string", "description": "The name of the group."},
          "device_count": {"type": "integer", "description": "Count of devices assigned to this group."},
          "descendent_device_count": {"type": "integer", "description": "Count of devices in the full hierarchy of this group."}
        }
      },
      "device": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "The ID of the device."},
          "hostname": {"type": "string", "description": "The hostname of the device."},
          "nickname": {"type": "string", "nullable": true, "description": "The nickname of the device."},
          "role": {"type": "string", "nullable": true, "enum": ["workstation", "server", "domain_controller"], "description": "The role of the device."},
          "group_id": {"type": "string", "nullable": true, "description": "The ID of the group the device is assigned to."},
          "tags": {"type": "array", "items": {"type": "string"}, "description": "The names of the tags applied to the device."},
          "flag": {"type": "string", "nullable": true, "description": "The active flag on the device."},
          "maintenance_mode": {"type": "boolean", "description": "Indicates if the device is in maintenance mode."},
          "online": {"type": "boolean", "description": "Indicates if the device is online."},
          "notes": {"type": "string", "nullable": true, "description": "User-created notes about the device."},
          "manufacturer": {"type": "string", "nullable": true, "description": "The manufacturer of the device."},
          "model": {"type": "string", "nullable": true, "description": "The model of the device."},
          "architecture": {"type": "string", "nullable": true, "description": "The architecture of the system."},
          "serial_number": {"type": "string", "nullable": true, "description": "The manufacturer's serial number."},
          "total_memory": {"type": "integer", "nullable": true, "description": "The total memory in bytes."},
          "memory_slots": {"type": "integer", "nullable": true, "description": "The total number of memory slots."},
          "cpu_cores": {"type": "integer", "nullable": true, "description": "The number of CPU cores."},
          "last_logged_in_user": {"type": "string", "nullable": true, "description": "The last user logged in."},
          "last_reboot_time": {"type": "string", "format": "date-time", "nullable": true, "description": "The last time the device was rebooted."},
          "city": {"type": "string", "nullable": true, "description": "The city the device is located in."},
          "country": {"type": "string", "nullable": true, "description": "The country the device is located in."},
          "security_score": {"type": "integer", "nullable": true, "description": "The security score of the device."},
          "platform": {"type": "string", "nullable": true, "enum": ["Windows", "Mac", "Linux"], "description": "The operating system platform."},
          "operating_system": {
            "type": "object",
            "properties": {
              "full_operating_system": {"type": "string", "nullable": true},
              "major_version": {"type": "string", "nullable": true},
              "minor_version": {"type": "string", "nullable": true},
              "architecture": {"type": "string", "nullable": true},
              "install_date": {"type": "string", "format": "date-time", "nullable": true},
              "end_of_life": {"type": "boolean"}
            }
          },
          "cpus": {"type": "array", "description": "The CPUs on the device."},
          "memory": {"type": "array", "description": "The memory on the device."},
          "disks": {"type": "array", "description": "The disks on the device."},
          "disk_partitions": {"type": "array", "description": "The disk partitions on the device."},
          "network_interfaces": {"type": "array", "description": "The network interfaces on the device."}
        }
      },
      "tag": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "The ID of the tag."},
          "name": {"type": "string", "description": "The tag name."},
          "device_count": {"type": "integer", "description": "The number of devices with this tag."}
        }
      },
      "custom_field": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "The ID of the custom field."},
          "name": {"type": "string", "description": "The custom field's name."},
          "reference": {"type": "string", "description": "How the field is referenced in automation scripts."},
          "admin_only": {"type": "boolean", "description": "This field's value can only be viewed or edited by an admin."}
        }
      },
      "custom_field_value": {
        "type": "object",
        "properties": {
          "custom_field_id": {"type": "string", "description": "The ID of the custom field."},
          "custom_field_name": {"type": "string", "description": "The name of the custom field."},
          "assigned_to_id": {"type": "string", "nullable": true, "description": "The ID of the object this value is assigned to."},
          "value": {"type": "string", "nullable": true, "description": "The value of the custom field."}
        }
      },
      "alert": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "The ID of the alert."},
          "device_id": {"type": "string", "description": "The ID of the device the alert is for."},
          "name": {"type": "string", "description": "The name of the alert."},
          "description": {"type": "string", "description": "The description of the alert."},
          "payload": {"type": "string", "nullable": true, "description": "The payload of the alert."},
          "severity": {"type": "string", "enum": ["information", "warning", "critical", "emergency"], "description": "The severity of the alert."},
          "is_resolved": {"type": "boolean", "description": "Indicates if the alert is resolved."},
          "started_at": {"type": "string", "format": "date-time", "description": "The start time of the alert in UTC."},
          "resolved_at": {"type": "string", "format": "date-time", "nullable": true, "description": "The time the alert was resolved in UTC."}
        }
      }
    }
  }
}
